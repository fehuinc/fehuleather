angular.module "CoreApp", [
  # Libs
  "ngRoute"
  "ngSanitize"
  "ngTouch"
  
  # Components
  "Deleter"
  "Editable"
  "StockQuantity"
  "ShoppingCart"
  "Sticky"

  # Directives
  "bimg"
  
  # Filters
  "reverse"
  
  # Services
  "Cart"
  "CartProduct"
  "cdStorage"
  "FeatureDetect"
  "ShippingAddress"
]

angular.module "WholesaleApp", [
  # Also include CoreApp
  "CoreApp"
  
  # Components
  "WholesaleItemEditor"
  
  # Services
  "CurrentOrder"
]

angular.module "PublicApp", [
  # Also include CoreApp
  "CoreApp"
  
  # Components
  "Product"
  "ProductInfo"
  "Specimens"
  
  # Directives
  "PageStyle"
  
  # Pages
  "About"
  "Checkout"
  "Events"
  "Locations"
  "Payment"
  "Shop"
  
  # Services
  "StubLocations"
  "Totem"
]

.config new Array "$locationProvider", "$routeProvider", ($locationProvider, $routeProvider)->
  $locationProvider.html5Mode enabled:true, requireBase:false
  
  $routeProvider
    .when "/",
      controller: "ShopCtrl"
      templateUrl: "<%= asset_path('pages/shop.html') %>"
    .when "/about",
      controller: "AboutCtrl"
      templateUrl: "<%= asset_path('pages/about.html') %>"
    .when "/checkout",
      controller: "CheckoutCtrl"
      templateUrl: "<%= asset_path('pages/checkout.html') %>"
    .when "/events",
      controller: "EventsCtrl"
      templateUrl: "<%= asset_path('pages/events.html') %>"
    .when "/locations",
      controller: "LocationsCtrl"
      templateUrl: "<%= asset_path('pages/locations.html') %>"
    .when "/payment",
      controller: "PaymentCtrl"
      templateUrl: "<%= asset_path('pages/payment.html') %>"
    .otherwise
      template: ""
      controller: ($route, $location, $window)->
        # Force Rails to handle this route
        document.location.reload()
