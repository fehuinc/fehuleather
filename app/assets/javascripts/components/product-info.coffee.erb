angular.module "ProductInfo", []

.directive "productInfo", new Array "Cart", "$rootScope", "$timeout", (Cart, $rootScope, $timeout)->
  templateUrl: "<%= asset_path('components/product-info.html') %>"
  link: (scope)->
    scope.isInCart = Cart.has
    scope.getQuantity = Cart.quantity
    
    scope.addToCart = (product)->
      Cart.add(product)
    
    scope.showInfo = (info)->
      if info != scope.showingInfo
        scope.showingInfo = info
      else
        scope.showingInfo = null
    
    scope.showCart = ()->
      document.body.scrollTop = 0
      
      $timeout (()-> $rootScope.cartShowing = true), 200
